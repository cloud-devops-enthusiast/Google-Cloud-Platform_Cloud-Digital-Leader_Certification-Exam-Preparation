**Google Cloud Architecture**

*Loose Coupling with Pub/Sub*

Whenever you want to decouple a publisher, consider Pub/Sub. Here Pub/Sub is used in the microservice architectures, IOT Architectures, Streaming Architectures. Here the architecture goes like you have mobile apps, on-prem services running or IOT services which are running and sending stream to Topic which is further being used with the subscriptions which takes the data to their different destinations like datawarehouse or much more.

*Cloud Dataproc*

Cloud dataproc is a fully managed and highly scalable service for running Apache Spark and Apache Hadoop based workloads. It supports variety of jobs like Spark, PySpark, SparkR, Hive, SparkSQL, Pig, Hadoop. This is mainly used to perform the complex batch processing.

It has multiple cluster modes like Single Node, Standard or Highly Availibility which has 3 masters nodes. It makes use of the virtual machine or regular/preemptible VMs.

Usecase: This is used to move your Hadoop and Spark clusters to the cloud. This lets you perform your machine learning and AI development using the Open Source frameworks.

Alternative to dataproc is BigQuery which can be used to run SQL queries on Petabytes. You can go towards Dataproc if you need more than queries (Example: Complex Batch processing machine learning and AI workloads).

Alternative to dataproc is Dataflow which can be simple pipelines without managing clusters and it is serverless so you do not need to manage the servers by yourself.

*Architecture 1 - Big Data Flow - Batch Ingest*

```
                -->     Cloud Dataproc  --|
                |                         | 
Cloud Storage ---->     Data Prep       ------>   BigQuery
                |                         |
                -->     Cloud Dataflow  --|
```

Here the scenario is something like this you have a lot of data in Cloud Storage and you want to process it till bigquery. Here we will be using ETL also known as Extract, Transform and Load to load the data into Bigquery.

Dataprep which is an another service offering by Google Cloud which is used for intelligent data service for visually exploring, cleaning, and preparing data for analysis, reporting and ML else in simple you can say it is used to clean and prepare the data.

Dataflow can be used to create the data pipelines (and do ETL Transactions), it is recommended if you want to have complex logic in place.

If you have hefty much of data processing work with bigdata workloads you can make use of Dataproc service which makes use of Spark and Hadoop.

As after this once your data is in BigQuery you can make use of the Data Studio which is one of the offering by google cloud which is used to visualize your data in BigQuery. It is mostly used to unlock the power of your data with the interactive dashboards and beautiful reports.

You can also make use of Looker where you can connect your data sources so you can get business intelligence out of it.

*Architecture 2 - Streaming Data*

```
                                          ----->    BigQuery
                                          |
Cloud Pub/Sub   --->    Cloud Dataflow  ---
                                          |
                                          ----->    Cloud BigTable
```

Here you have to handle the streaming data. Here we are having Pub/Sub to receive the messages from the subscriptions on the topic. If you have a bit of more complex data processing you can have the Dataflow in place as it will be able to analyse, aggregate and filter the data.

Now you can load your data into BigQuery or whether in Cloud BigTable.

If you have pre-defined time series analytics, storing the data in Bigtable makes more sense that gives you the ability to perform rapid analysis.

For ad hoc complex analysis, you can go ahead with BigQuery.

*Architecture 3 - IOT*

```
Cloud IOT Core
       |
       |
       V
Cloud Pub/Sub
       |
       |        ----->  Cloud Datastore
       V        |
Cloud Dataflow------->  BigQuery
                |
                ----->  Cloud BigTable
```

IOT Core is a offering of Google cloud intended for IOT based workloads, which is used to manage IOT (Registration, Authenticationb and Authorization operations) for devices. Here it used to Send/Receive messages/Real-time telemetry from/to IOT devices.

As you come to know about the word messages you must have Cloud Pub/Sub in place which is a durable message ingestion service (allows the buffering).

Now you can have Dataflow so you can do the ETL and processing data. Here you can have Cloud Functions as well so they can trigger the alerts

At Last we have data storage and analytics usecase that makes,

the IOT Data available to mobile or webapps you can make use of Datastore or filestore,

if you want to execute the pre-defined time series queries or real time analysis you can make use of Bigtable,

if you want to make more complex or ad hoc analytics/analysis you have BigQuery as your solution.